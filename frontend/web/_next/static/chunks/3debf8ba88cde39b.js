(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,2551,e=>{"use strict";var t=e.i(71645);let a=`
  query {
    matchState {
      players {
        nickname
        handSize
        calledLastCard
      }
      currentPlayerIndex
      status
      deckSize
      discardPile {
        suit
        value
      }
    }
  }
`,s=`
  query {
    myHand {
      suit
      value
    }
  }
`;function l(){let[l,n]=(0,t.useState)(null),[r,i]=(0,t.useState)(!0),[c,o]=(0,t.useState)(null),[d,x]=(0,t.useState)(null),[h,m]=(0,t.useState)(1);(0,t.useEffect)(()=>{e.A(29530).then(({createLineraClient:e,getGlobalConfig:t})=>{try{let a=t();m(a.playerNumber||1);let s=e();x(s)}catch(e){console.error("Config not ready yet",e)}})},[]);let u=(0,t.useCallback)(async()=>{if(d)try{let t=await e.A(29530).then(e=>e.getGlobalConfig()),l=await d.query(a,{},t.endpoints[0].chainId),r=await d.query(s,{},t.endpoints[0].chainId);if(l.matchState){let e={myCards:r.myHand||[],myCardCount:r.myHand?.length||0,calledLastCard:!1,opponents:l.matchState.players.filter((e,t)=>e&&t!==h-1).map(e=>({owner:"",nickname:e.nickname,cardCount:e.handSize,isActive:!0,calledLastCard:e.calledLastCard||!1})),topCard:l.matchState.discardPile[l.matchState.discardPile.length-1],deckSize:l.matchState.deckSize,currentPlayerIndex:l.matchState.currentPlayerIndex,status:l.matchState.status,activeShapeDemand:null,pendingPenalty:0};n(e)}o(null)}catch(e){console.error("Failed to fetch game state:",e),o(e)}finally{i(!1)}},[d,h]);(0,t.useEffect)(()=>{if(!d)return;u();let e=setInterval(u,500);return()=>clearInterval(e)},[u,d]);let f=(0,t.useCallback)(async(t,a=3)=>{if(d)for(let s=0;s<a;s++)try{let a=await e.A(29530).then(e=>e.getGlobalConfig());await d.mutate(`
            mutation JoinGame($playChainId: String!, $nickname: String!) {
              joinMatch(playChainId: $playChainId, nickname: $nickname)
            }
          `,{playChainId:a.playChain,nickname:t},a.endpoints[0].chainId),await u();return}catch(t){if(console.error(`Join attempt ${s+1}/${a} failed:`,t),s===a-1)throw t;let e=1e3*Math.pow(2,s);console.log(`Retrying in ${e}ms...`),await new Promise(t=>setTimeout(t,e))}},[d,u]),p=(0,t.useCallback)(async()=>{if(d)try{let t=await e.A(29530).then(e=>e.getGlobalConfig());await d.mutate("mutation { startMatch }",{},t.endpoints[0].chainId),await u()}catch(e){throw console.error("Failed to start game:",e),e}},[d,u]),g=(0,t.useCallback)(async(t,a)=>{if(d)try{let s=await e.A(29530).then(e=>e.getGlobalConfig());await d.mutate(`
        mutation PlayCard($cardIndex: Int!, $chosenSuit: String) {
          playCard(cardIndex: $cardIndex, chosenSuit: $chosenSuit)
        }
      `,{cardIndex:t,chosenSuit:a},s.endpoints[0].chainId),await u()}catch(e){throw console.error("Failed to play card:",e),e}},[d,u]);return{gameState:l,loading:r,error:c,joinGame:f,startGame:p,playCard:g,drawCard:(0,t.useCallback)(async()=>{if(d)try{let t=await e.A(29530).then(e=>e.getGlobalConfig());await d.mutate("mutation { drawCard }",{},t.endpoints[0].chainId),await u()}catch(e){throw console.error("Failed to draw card:",e),e}},[d,u]),callLastCard:(0,t.useCallback)(async()=>{if(d)try{let t=await e.A(29530).then(e=>e.getGlobalConfig());await d.mutate("mutation { callLastCard }",{},t.endpoints[0].chainId),await u()}catch(e){throw console.error("Failed to call last card:",e),e}},[d,u]),refresh:u,playerNumber:h}}e.s(["useWhotGame",()=>l])},25821,e=>{"use strict";var t=e.i(43476),a=e.i(71645);function s(){return(0,t.jsxs)("div",{className:"w-64 h-48 bg-white/20 backdrop-blur-sm rounded-lg border border-white/30 p-4 flex flex-col",children:[(0,t.jsx)("h3",{className:"text-[#01626F] font-bold mb-2",children:"Live Chat"}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto text-sm text-[#01626F] italic",children:(0,t.jsx)("p",{children:"Chat feature coming soon..."})})]})}function l(){return(0,t.jsx)("div",{className:"w-32 h-16 bg-[#EA463D] rounded-lg shadow-lg flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-white font-lilitaone text-2xl",children:"00:30"})})}function n({playerNumber:e,gameState:a}){return(0,t.jsxs)("div",{className:"w-64 bg-white/80 rounded-lg p-4 shadow-lg text-[#01626F]",children:[(0,t.jsx)("h3",{className:"font-bold mb-2",children:"Players"}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)("span",{children:["You (P",e,")"]}),(0,t.jsxs)("span",{children:[a.myCardCount," cards"]})]}),a.opponents.map((e,a)=>(0,t.jsxs)("div",{className:"flex justify-between text-gray-600",children:[(0,t.jsx)("span",{children:e.nickname}),(0,t.jsxs)("span",{children:[e.cardCount," cards"]})]},a))]})}function r({deckSize:e,onDraw:a}){return(0,t.jsx)("div",{className:"w-32 h-44 bg-[#01626F] rounded-xl border-4 border-white flex items-center justify-center cursor-pointer shadow-xl transform transition active:scale-95",onClick:a,children:(0,t.jsxs)("div",{className:"text-white text-center",children:[(0,t.jsx)("p",{className:"font-lilitaone text-xl",children:"DRAW"}),(0,t.jsxs)("p",{className:"font-bold text-sm",children:[e," Cards"]})]})})}function i({opponent:e,topCard:a}){return e?(0,t.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,t.jsx)("div",{className:"bg-[#01626F] text-white px-6 py-2 rounded-full font-bold shadow-lg",children:e.nickname}),(0,t.jsxs)("div",{className:"flex gap-2",children:[Array.from({length:Math.min(e.cardCount,5)}).map((e,a)=>(0,t.jsx)("div",{className:"w-16 h-24 bg-blue-800 rounded-lg border-2 border-white shadow-md"},a)),e.cardCount>5&&(0,t.jsxs)("div",{className:"w-16 h-24 flex items-center justify-center text-[#01626F] font-bold",children:["+",e.cardCount-5]})]})]}):(0,t.jsx)("div",{className:"h-32"})}function c({myCards:e,isMyTurn:a,onPlayCard:s,onDrawCard:l,onCallLastCard:n}){return(0,t.jsxs)("div",{className:"flex flex-col items-center gap-6",children:[a&&(0,t.jsx)("div",{className:"text-xl text-[#EA463D] font-bold animate-bounce",children:"YOUR TURN!"}),(0,t.jsx)("div",{className:"flex flex-wrap justify-center gap-[-40px]",children:e.map((e,l)=>(0,t.jsxs)("div",{onClick:()=>a&&s(l),className:`w-24 h-36 bg-white rounded-xl border-2 border-gray-200 shadow-xl flex flex-col items-center justify-center cursor-pointer hover:-translate-y-4 transition-transform ${!a&&"opacity-70 cursor-not-allowed"}`,style:{marginLeft:l>0?"-40px":"0"},children:[(0,t.jsx)("span",{className:`text-3xl font-bold ${(e=>{switch(e?.toUpperCase()){case"CIRCLE":return"text-red-500";case"TRIANGLE":return"text-green-500";case"CROSS":return"text-blue-500";case"SQUARE":return"text-orange-500";case"STAR":return"text-purple-500";default:return"text-black"}})(e.suit)}`,children:e.value}),(0,t.jsx)("span",{className:"text-xs text-gray-400",children:e.suit})]},l))}),(0,t.jsx)("div",{className:"flex gap-4",children:(0,t.jsx)("button",{onClick:n,className:"px-6 py-2 bg-[#EA463D] text-white rounded-full font-bold shadow-lg hover:bg-[#d63a32] transition",children:"LAST CARD!"})})]})}var o=e.i(2551);function d(){let{gameState:e,loading:d,error:x,joinGame:h,startGame:m,playCard:u,drawCard:f,callLastCard:p,playerNumber:g}=(0,o.useWhotGame)(),[y,b]=(0,a.useState)("");return((0,a.useEffect)(()=>{let e=localStorage.getItem(`whot_player_profile_${g}`);if(e)try{let t=JSON.parse(e);t.username&&b(t.username)}catch(e){console.error("Failed to parse profile",e)}},[g]),d)?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-[#77F0FC]",children:(0,t.jsx)("p",{className:"text-3xl font-lilitaone text-[#01626F] animate-pulse",children:"Loading game..."})}):x?(0,t.jsxs)("div",{className:"min-h-screen flex items-center justify-center flex-col gap-4 bg-[#77F0FC]",children:[(0,t.jsx)("p",{className:"text-2xl text-red-600 font-bold",children:"Connection Error"}),(0,t.jsx)("p",{className:"text-[#01626F]",children:x.message}),(0,t.jsx)("button",{onClick:()=>window.location.reload(),className:"px-6 py-2 bg-[#0FB6C6] text-white rounded-lg",children:"Retry"})]}):e?"WAITING"===e.status.toUpperCase()?(0,t.jsx)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-b from-[#77F0FC] to-[#19D3F9]",children:(0,t.jsxs)("div",{className:"bg-white/30 backdrop-blur-md p-10 rounded-2xl shadow-xl flex flex-col items-center gap-6 w-[500px]",children:[(0,t.jsx)("h1",{className:"text-4xl font-lilitaone text-[#01626F]",children:"Lobby"}),(0,t.jsxs)("div",{className:"w-full bg-white/50 rounded-lg p-4",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-[#01626F] mb-2",children:"Players Joined:"}),(0,t.jsxs)("ul",{className:"space-y-2",children:[e.opponents.map((e,a)=>(0,t.jsxs)("li",{className:"flex justify-between items-center text-[#01626F]",children:[(0,t.jsx)("span",{children:e.nickname||"Unknown"}),(0,t.jsx)("span",{className:"bg-green-400 text-white text-xs px-2 py-1 rounded-full",children:"Ready"})]},a)),(0,t.jsxs)("li",{className:"flex justify-between items-center text-[#01626F] font-bold",children:[(0,t.jsxs)("span",{children:["You (Player ",g,")"]}),(0,t.jsx)("span",{className:"bg-green-400 text-white text-xs px-2 py-1 rounded-full",children:"Ready"})]})]})]}),1===g?(0,t.jsx)("button",{onClick:()=>m(),disabled:e.opponents.length<1,className:`px-8 py-4 text-white text-2xl font-lilitaone rounded-full shadow-lg transform transition ${e.opponents.length<1?"bg-gray-400 cursor-not-allowed":"bg-[#EA463D] hover:bg-[#d63a32] active:scale-95"}`,children:"Start Match"}):(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("p",{className:"text-lg text-[#01626F] animate-pulse font-bold",children:"Waiting for host to start..."})})]})}):(0,t.jsxs)("div",{className:"min-h-screen w-full relative overflow-hidden flex gap-x-[50px] px-5 bg-gradient-to-b from-[#77F0FC] to-[#19D3F9]",children:[(0,t.jsxs)("div",{className:"space-y-12 pt-10",children:[(0,t.jsx)(s,{}),(0,t.jsx)(l,{})]}),(0,t.jsxs)("div",{className:"flex-1 space-y-20 pt-10",children:[(0,t.jsx)(i,{opponent:e.opponents[0],topCard:e.topCard}),(0,t.jsx)("img",{src:"/middle-cards.png",className:"mx-auto",alt:""}),(0,t.jsx)(c,{myCards:e.myCards,isMyTurn:e.currentPlayerIndex===g-1,onPlayCard:e=>u(e),onDrawCard:f,onCallLastCard:p})]}),(0,t.jsxs)("div",{className:"space-y-[46px]",children:[(0,t.jsx)(n,{playerNumber:g,gameState:e}),(0,t.jsx)(r,{deckSize:e.deckSize,onDraw:f})]})]}):(0,t.jsx)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-b from-[#77F0FC] to-[#19D3F9]",children:(0,t.jsxs)("div",{className:"bg-white/30 backdrop-blur-md p-10 rounded-2xl shadow-xl flex flex-col items-center gap-6 border border-white/50",children:[(0,t.jsxs)("h1",{className:"text-4xl font-lilitaone text-[#01626F]",children:["Welcome ",y||`Player ${g}`]}),(0,t.jsx)("p",{className:"text-[#01626F] text-lg",children:"Connect to the game server to start playing."}),(0,t.jsx)("button",{onClick:()=>h(y||`Player ${g}`),className:"px-8 py-4 bg-[#EA463D] hover:bg-[#d63a32] text-white text-2xl font-lilitaone rounded-full shadow-lg transform transition active:scale-95",children:"Join Game"})]})})}e.s(["default",()=>d],25821)},29530,e=>{e.v(e=>Promise.resolve().then(()=>e(13209)))}]);